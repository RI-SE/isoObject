project(ISO_object LANGUAGES C CXX)
cmake_minimum_required(VERSION 3.1)
set(CMAKE_C_STANDARD 14)
set(CMAKE_C_STANDARD_REQUIRED ON)

set(CMAKE_CXX_STANDARD 14)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

set(CMAKE_BUILD_TYPE Debug)

# Manage namespace of the project
set(ISOOBJECT_TARGET ${PARENT_TARGET_NAMESPACE}${PROJECT_NAME})
set(ISOOBJECT_LIBRARY ${PARENT_TARGET_NAMESPACE}ISOobject)

set(ISO22133_LIBRARY ${TARGET_NAMESPACE}ISO22133)
set(SOCKET_LIBRARY ${TARGET_NAMESPACE}TCPUDPSocket)
set(TIME_LIBRARY ${TARGET_NAMESPACE}MaestroTime)


include(GNUInstallDirs)

get_target_property(ISO22133_HEADERS ${ISO22133_LIBRARY} INCLUDE_DIRECTORIES)

add_library(${ISOOBJECT_LIBRARY} SHARED
        ${CMAKE_CURRENT_SOURCE_DIR}/src/iso22133object.cpp
        ${CMAKE_CURRENT_SOURCE_DIR}/src/iso22133state.cpp
)

target_include_directories(${ISOOBJECT_LIBRARY} PUBLIC
	${CMAKE_CURRENT_SOURCE_DIR}/inc
	${CMAKE_CURRENT_SOURCE_DIR}/sigslot/include/
	${ISO22133_HEADERS}
)

add_executable(${ISOOBJECT_TARGET} testIsoObject.cpp)

target_include_directories(${ISOOBJECT_TARGET} PUBLIC
	${CMAKE_CURRENT_SOURCE_DIR}/inc
	${ISO22133_HEADERS}
)

target_link_libraries(${ISOOBJECT_TARGET} LINK_PUBLIC
	${ISOOBJECT_LIBRARY}
	${SOCKET_LIBRARY}
	${ISO22133_LIBRARY}
	${TIME_LIBRARY}
	pthread
)

install(TARGETS ${ISOOBJECT_TARGET}
	RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
	LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
	ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}
	PUBLIC_HEADER DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}
)
